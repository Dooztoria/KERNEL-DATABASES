#!/bin/bash
K=$(uname -r)
E=()
[ -u /usr/bin/pkexec ]&&E+=('{"cve":"CVE-2021-4034","name":"PwnKit - pkexec SUID","rate":95}')
[[ "$K" > "5.8" && "$K" < "5.17" ]]&&E+=('{"cve":"CVE-2022-0847","name":"DirtyPipe - kernel overwrite","rate":90}')
[[ "$K" < "4.9" ]]&&E+=('{"cve":"CVE-2016-5195","name":"DirtyCOW - race condition","rate":80}')
sudo -l 2>/dev/null|grep -q NOPASSWD&&E+=('{"cve":"SUDO-NOPASSWD","name":"Sudo without password","rate":99}')
printf '{"exploits":['
for i in "${!E[@]}";do [[ $i -gt 0 ]]&&printf ','
printf '%s' "${E[$i]}";done
printf ']}'
